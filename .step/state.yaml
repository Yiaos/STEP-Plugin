# STEP Protocol — 项目状态（由协议自动维护）
# ⚡ 规则: 每次 Write/Edit 后检查 progress_log / key_decisions 是否需要更新
# ⚡ 规则: next_action 必须精确到文件名+动作，禁止写"继续开发"
# ⚡ 规则: 修改文件前必须先 Read，不得凭记忆编辑
# ⚡ 规则: 每 2 次工具调用后自省是否需要更新状态
# ⚡ 规则: key_decisions / progress_log 倒序写入（最新条目在最前）
project: "STEP-Plugin"
project_type: "existing"
current_phase: "idle"
current_change: ""
last_updated: "2026-02-16"
last_agent: "orchestrator"
last_session_summary: "完整重建：baseline（协议全貌快照）+ decisions.md（精简为 4 条核心 ADR）+ state.yaml 同步精简。"

established_patterns:
  hook_mechanism: "SKILL.md frontmatter → PreToolUse/PostToolUse/Stop"
  attention_injection: "cat state.yaml | head -25 → 注入行为规则+状态数据"
  quality_gates: "gate.sh + scenario-check.sh + step-stop-check.sh"
  agent_system: "7 roles with BMAD-style prompts"
  config_architecture: "agent .md → config.yaml routing → file_routing → gate"

tasks:
  current: null
  upcoming: []

key_decisions:
  - decision: "baseline 语义从冻结合同改为活快照（ADR-005）"
    reason: "文件系统无写保护，冻结语义与现实矛盾；CR 改为审计记录"
    date: "2026-02-15"
  - decision: "7 角色 agent 体系 + BMAD 风格提示词"
    reason: "角色分离形成对抗性，BMAD 人设提高 LLM 行为质量"
    date: "2026-02-15"
  - decision: "state.yaml 头部嵌入行为规则"
    reason: "混合规则+数据的注入方式 LLM 遵循率更高"
    date: "2026-02-14"

known_issues: []

constraints_quick_ref:
  - "脚本兼容 macOS bash 3.2+ 和 Linux bash 4+"
  - "state.yaml 向后兼容"

progress_log:
  - date: "2026-02-16"
    summary: "完整重建：baseline（协议全貌快照）+ decisions.md（5条→4条核心ADR）+ state.yaml 精简。对比文档修正，整理流程补入 SKILL.md/WORKFLOW.md"
    next_action: "idle — 等待用户发起下一项任务"
  - date: "2026-02-15"
    summary: "MVP 完成 + Post-MVP（7角色agent/routing/注入/归档）+ baseline 语义变更（ADR-005）+ 一致性修复 + 3 任务归档"
    next_action: "idle"
